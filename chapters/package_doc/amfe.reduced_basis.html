<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>amfe.reduced_basis module &#8212; AMfe 0.2 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="This is the documentation of AMfe">
    <meta name="author" content="Johannes Rutzmoser and Christian Meyer">
    <link rel="icon" href="../../favicon.ico">

    
    <!-- Bootstrap core CSS -->
    <link href="../../_static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="../../_static/css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet"> -->

    <!-- Custom styles for this template -->
    <link href="../../_static/css/theme.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- <script src="../../assets/js/ie-emulation-modes-warning.js"></script> -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      
      
    <![endif]-->

  </head>
  <body role="document">

    <div class="document">


       <!-- Static navbar -->
    <nav class="navbar navbar-toggleable-md navbar-inverse bg-primary" id="main-nav">
        <div class="container-fluid">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="#"><img src="../../_static/img/logo.png" alt="" width="30" height="30" class="d-inline-block align-top">
                  AMfe Documentation
              </a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
              <ul class="nav navbar-nav">
                <li class="nav-item active"><a href="../../index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="../getting_started/index.html">Tutorials</a></li>
                <li class="nav-item"><a class="nav-link" href="../fundamentals/index.html">Fundamentals</a></li>
                <li class="nav-item"><a class="nav-link" href="../examples/index.html">Examples</a></li>
                <li class="nav-item"><a class="nav-link" href="../../contents.html">Table of Contents</a></li>
                <li class="nav-item"><a class="nav-link" href="../../genindex.html">Index</a></li>
                <li class="nav-item"><a class="nav-link" href="../../py-modindex.html">Modules</a></li>
              </ul>
            </div>
        </div>
    </nav>
    
    
    <div class="container">
        <div class="row">
            
    <ul class="pager">
      <li class="previous">
        <a title="AMfe 0.2 documentation" href="../../index.html" accesskey="U">up</a>
      </li>
      </ul>
        </div>
        <div class="row">
            
  <div class="section" id="module-amfe.reduced_basis">
<span id="amfe-reduced-basis-module"></span><h1>amfe.reduced_basis module<a class="headerlink" href="#module-amfe.reduced_basis" title="Permalink to this headline">¶</a></h1>
<p>Reduced basis methods...</p>
<dl class="function">
<dt id="amfe.reduced_basis.krylov_subspace">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">krylov_subspace</code><span class="sig-paren">(</span><em>M</em>, <em>K</em>, <em>b</em>, <em>omega=0</em>, <em>no_of_moments=3</em>, <em>mass_orth=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#krylov_subspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.krylov_subspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Krylov Subspace associated with the input matrix b at the
frequency omega.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>M</strong> (<em>ndarray</em>) &#8211; Mass matrix of the system.</li>
<li><strong>K</strong> (<em>ndarray</em>) &#8211; Stiffness matrix of the system.</li>
<li><strong>b</strong> (<em>ndarray</em>) &#8211; input vector of external forcing.</li>
<li><strong>omega</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; frequency for the frequency shift of the stiffness. Default value 0.</li>
<li><strong>no_of_moments</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; number of moments matched. Default value 3.</li>
<li><strong>mass_orth</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; flag for setting orthogonality of returnd Krylov basis vectors. If
True, basis vectors are mass-orthogonal (V.T &#64; M &#64; V = eye). If False,
basis vectors are orthogonal (V.T &#64; V = eye)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>V</strong> &#8211; Krylov basis where vectors V[:,i] give the basis vectors.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>TODO</p>
<p class="rubric">References</p>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.compute_modes_pardiso">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">compute_modes_pardiso</code><span class="sig-paren">(</span><em>mechanical_system</em>, <em>n=10</em>, <em>u_eq=None</em>, <em>save=False</em>, <em>niter_max=40</em>, <em>rtol=1e-14</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#compute_modes_pardiso"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.compute_modes_pardiso" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a modal analysis using a naive Lanczos iteration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mechanical_system</strong> (<em>instance of amfe.MechanicalSystem</em>) &#8211; Mechanical system</li>
<li><strong>n</strong> (<em>int</em>) &#8211; number of modes to be computed</li>
<li><strong>u_eq</strong> (<em>ndarray</em><em>, </em><em>optional</em>) &#8211; equilibrium position, around which the vibration modes should be
computed</li>
<li><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; flat setting, if the modes should be saved in mechanical system.
Default value: False</li>
<li><strong>niter_max</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Maximum number of Lanzcos iterations</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>om</strong> (<em>ndarray, shape(n)</em>) &#8211; eigenfrequencies of the system</li>
<li><strong>Phi</strong> (<em>ndarray, shape(ndim, n)</em>) &#8211; Vibration modes of the system</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In comparison to the modal_analysis method, this method uses the Pardiso
solver if available and a naive Lanczos iteration. The modal_analysis method
uses the arpack solver which is more accurate but takes also much longer for
large systems, since the factorization is very inefficient by using superLU.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.vibration_modes">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">vibration_modes</code><span class="sig-paren">(</span><em>mechanical_system</em>, <em>n=10</em>, <em>save=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#vibration_modes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.vibration_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the n first vibration modes of the given mechanical system using
a power iteration method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mechanical_system</strong> (<em>instance of MechanicalSystem</em>) &#8211; Mechanical system to be analyzed.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; number of modes to be computed.</li>
<li><strong>save</strong> (<em>bool</em>) &#8211; Flag for saving the modes in mechanical_system for ParaView export.
Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>omega</strong> (<em>ndarray</em>) &#8211; vector containing the eigenfrequencies of the mechanical system in
rad / s.</li>
<li><strong>Phi</strong> (<em>ndarray</em>) &#8211; Array containing the vibration modes. Phi[:,0] is the first vibration
mode corresponding to eigenfrequency omega[0]</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p class="rubric">Notes</p>
<p>The core command using the ARPACK library is a little bit tricky. One has
to use the shift inverted mode for the solution of the mechanical
eigenvalue problem with the largest eigenvalues. Generally no convergence
is gained when the smallest eigenvalue is to be found.</p>
<p>If the squared eigenvalue omega**2 is negative, as it might happen due to
round-off errors with rigid body modes, the negative sign is traveled to
the eigenfrequency omega, though this makes physically no sense...</p>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.craig_bampton">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">craig_bampton</code><span class="sig-paren">(</span><em>M</em>, <em>K</em>, <em>b</em>, <em>no_of_modes=5</em>, <em>one_basis=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#craig_bampton"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.craig_bampton" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Craig-Bampton basis for the System M and K with the input
Matrix b.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>M</strong> (<em>ndarray</em>) &#8211; Mass matrix of the system.</li>
<li><strong>K</strong> (<em>ndarray</em>) &#8211; Stiffness matrix of the system.</li>
<li><strong>b</strong> (<em>ndarray</em>) &#8211; Input vector of the system</li>
<li><strong>no_of_modes</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Number of internal vibration modes for the reduction of the system.
Default is 5.</li>
<li><strong>one_basis</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; Flag for setting, if one Craig-Bampton basis should be returned or if
the static and the dynamic basis is chosen separately</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>if <cite>one_basis=True</cite> is chosen</li>
<li><strong>V</strong> (<em>array</em>) &#8211; Basis constisting of static displacement modes and internal vibration
modes</li>
<li>if <cite>one_basis=False</cite> is chosen</li>
<li><strong>V_static</strong> (<em>ndarray</em>) &#8211; Static displacement modes corresponding to the input vectors b with
V_static[:,i] being the corresponding static displacement vector to
b[:,i].</li>
<li><strong>V_dynamic</strong> (<em>ndarray</em>) &#8211; Internal vibration modes with the boundaries fixed.</li>
<li><strong>omega</strong> (<em>ndarray</em>) &#8211; eigenfrequencies of the internal vibration modes.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>TODO</p>
<p class="rubric">Notes</p>
<p>There is a filter-out command to remove the interface eigenvalues of the
system.</p>
<p class="rubric">References</p>
<p>TODO</p>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.pod">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">pod</code><span class="sig-paren">(</span><em>mechanical_system</em>, <em>n=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#pod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.pod" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the POD basis of a mechanical system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mechanical_system</strong> (<em>instance of MechanicalSystem</em>) &#8211; MechanicalSystem which has run a time simulation and thus displacement
fields stored internally.</li>
<li><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Number of POD basis vectors which should be returned. Default is <cite>None</cite>
returning all POD vectors.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>sigma</strong> (<em>ndarray</em>) &#8211; Array of the singular values.</li>
<li><strong>V</strong> (<em>ndarray</em>) &#8211; Array containing the POD vectors. V[:,0] contains the POD-vector
associated with sigma[0] etc.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>TODO</p>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.modal_derivatives">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">modal_derivatives</code><span class="sig-paren">(</span><em>V</em>, <em>omega</em>, <em>K_func</em>, <em>M</em>, <em>h=1.0</em>, <em>verbose=True</em>, <em>symmetric=True</em>, <em>finite_diff='central'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#modal_derivatives"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.modal_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the basis theta based on real modal derivatives.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>V</strong> (<em>ndarray</em>) &#8211; array containing the linear basis</li>
<li><strong>omega</strong> (<em>ndarray</em>) &#8211; eigenfrequencies of the system in rad/s.</li>
<li><strong>K_func</strong> (<em>function</em>) &#8211; function returning the tangential stiffness matrix for a given
displacement. Has to work like K = K_func(u).</li>
<li><strong>M</strong> (<em>ndarray</em><em> or </em><em>sparse matrix</em>) &#8211; Mass matrix of the system.</li>
<li><strong>h</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; step width for finite difference scheme. Default value is 500 * machine
epsilon</li>
<li><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; flag for verbosity. Default value: True</li>
<li><strong>symmetric</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; flag for making the modal derivative matrix theta symmetric. Default is
<cite>True</cite>.</li>
<li><strong>finite_diff</strong> (<em>str {'central'</em><em>, </em><em>'upwind'}</em>) &#8211; Method for finite difference scheme. &#8216;central&#8217; computes the finite difference
based on a central difference scheme, &#8216;upwind&#8217; based on an upwind scheme. Note
that the upwind scheme can cause severe distortions of the modal derivative.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Theta</strong> &#8211; three dimensional array of modal derivatives. Theta[:,i,j] contains
the modal derivative 1/2 * dx_i / dx_j. The basis Theta is made symmetric, so
that <cite>Theta[:,i,j] == Theta[:,j,i]</cite> if <cite>symmetic=True</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-func docutils literal"><span class="pre">static_correction_theta()</span></code></dt>
<dd>modal derivative with mass neglection.</dd>
<dt><code class="xref py py-func docutils literal"><span class="pre">modal_derivative()</span></code></dt>
<dd>modal derivative for only two vectors.</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.static_derivatives">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">static_derivatives</code><span class="sig-paren">(</span><em>V</em>, <em>K_func</em>, <em>M=None</em>, <em>omega=0</em>, <em>h=1.0</em>, <em>verbose=True</em>, <em>symmetric=True</em>, <em>finite_diff='central'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#static_derivatives"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.static_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the static correction derivatives for the given basis V.</p>
<p>Optionally, a frequency shift can be performed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>V</strong> (<em>ndarray</em>) &#8211; array containing the linear basis</li>
<li><strong>K_func</strong> (<em>function</em>) &#8211; function returning the tangential stiffness matrix for a given
displacement. Has to work like <cite>K = K_func(u)</cite>.</li>
<li><strong>M</strong> (<em>ndarray</em><em>, </em><em>optional</em>) &#8211; mass matrix. Can be sparse or dense. If <cite>None</cite> is given, the mass of 0
is assumed. Default value is <cite>None</cite>.</li>
<li><strong>omega</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; shift frequency. Default value is 0.</li>
<li><strong>h</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; step width for finite difference scheme. Default value is 500 * machine
epsilon</li>
<li><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; flag for verbosity. Default value: True</li>
<li><strong>finite_diff</strong> (<em>str {'central'</em><em>, </em><em>'forward'</em><em>, </em><em>backward}</em>) &#8211; Method for finite difference scheme. &#8216;central&#8217; computes the finite
difference based on a central difference scheme, &#8216;forward&#8217; based on an
forward scheme etc. Note that the upwind scheme can cause severe
distortions of the static correction derivative.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Theta</strong> &#8211; three dimensional array of static corrections derivatives. Theta[:,i,j]
contains the static derivative 1/2 * dx_i / dx_j. As the static
derivatives are symmetric, Theta[:,i,j] == Theta[:,j,i].</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal"><span class="pre">modal_derivative_theta()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">static_correction_derivative()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.augment_with_derivatives">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">augment_with_derivatives</code><span class="sig-paren">(</span><em>V</em>, <em>theta</em>, <em>M=None</em>, <em>tol=1e-08</em>, <em>symm=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#augment_with_derivatives"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.augment_with_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a linear basis containing the subspace spanned by V and theta by
deflation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>V</strong> (<em>ndarray</em>) &#8211; linear basis</li>
<li><strong>theta</strong> (<em>ndarray</em>) &#8211; third order tensor filled with the modal derivatices associated with V</li>
<li><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Tolerance for the deflation via SVD. The omitted singular values are
at least smaller than the largest one multiplied with tol.
Default value: 1E-8.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>V_ret</strong> &#8211; linear basis containing the subspace spanned by V and theta.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.augment_with_ranked_derivatives">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">augment_with_ranked_derivatives</code><span class="sig-paren">(</span><em>V</em>, <em>Theta</em>, <em>W</em>, <em>n</em>, <em>tol=1e-08</em>, <em>symm=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#augment_with_ranked_derivatives"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.augment_with_ranked_derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a linear basis from a linear basis V and a QM Tensor Theta with
a given weighting matrix W.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>V</strong> (<em>ndarray</em><em>, </em><em>shape:</em><em> (</em><em>ndim</em><em>, </em><em>m</em><em>)</em><em></em>) &#8211; Linear basis</li>
<li><strong>Theta</strong> (<em>narray</em><em>, </em><em>shape:</em><em> (</em><em>ndim</em><em>, </em><em>m</em><em>, </em><em>m</em><em>)</em><em></em>) &#8211; Third order tensor containing the derivatives</li>
<li><strong>W</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>m</em><em>, </em><em>m</em><em>)</em><em></em>) &#8211; Weighting matrix containing the weights</li>
<li><strong>n</strong> (<em>int</em>) &#8211; number of derivative vectors</li>
<li><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; tolerance for the SVD selection. Default value: 1E-8</li>
<li><strong>symm</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; flag if weighting matrix and Theta is symmetric. If true, only the
upper half of Theta and W is evaluated</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>V_red</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray, shape: (ndim, n + m)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="amfe.reduced_basis.ranking_of_weighting_matrix">
<code class="descclassname">amfe.reduced_basis.</code><code class="descname">ranking_of_weighting_matrix</code><span class="sig-paren">(</span><em>W</em>, <em>symm=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/amfe/reduced_basis.html#ranking_of_weighting_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#amfe.reduced_basis.ranking_of_weighting_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indices of a weighting matrix W in decreasing order</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>W</strong> (<em>ndarray</em><em>, </em><em>shape:</em><em> (</em><em>n</em><em>, </em><em>m</em><em>)</em><em></em>) &#8211; weighting matrix</li>
<li><strong>symm</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; flag indicating symmetry</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>idxs</strong> &#8211; array of indices, where i, j = idxs[k] are the indices of the k-largest
value in W</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray, shape (n*m, 2)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


        </div>
        <div class="row">
            
    <ul class="pager">
      <li class="previous">
        <a title="AMfe 0.2 documentation" href="../../index.html" accesskey="U">up</a>
      </li>
      </ul>
        </div>
    </div>

    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
<script src="../../_static/js/bootstrap.min.js"></script>
<script src="../../_static/js/theme.js"></script>
<script>loader();</script>

      <div class="clearer"></div>
    </div>
  </body>
</html>